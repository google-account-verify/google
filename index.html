<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verify it's you - Google Accounts</title>
    <link rel="icon" href="https://www.google.com/favicon.ico">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet">
    <style>
        /* Google Sans Simulation */
        @font-face {
            font-family: 'Google Sans';
            font-style: normal;
            font-weight: 400;
            src: local('Google Sans Regular'), local('GoogleSans-Regular'), url(https://fonts.gstatic.com/s/googlesans/v14/4UaGrENHsxJlGDuGo1OIlL3Owp4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
        }
        
        body {
            font-family: 'Roboto', arial, sans-serif;
            background-color: #f0f4f9; /* Modern Google Background */
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            margin: 0;
        }

        /* The Card - Modern Vertical Square Style */
        .login-card {
            background: white;
            width: 100%;
            max-width: 448px; 
            padding: 48px 40px 36px; /* Adjusted padding for vertical feel */
            border-radius: 28px; /* Newer Material 3 rounds */
            transition: height 0.3s ease;
            position: relative;
            overflow: hidden; /* Keeps progress bar inside corners */
        }

        @media (min-width: 601px) {
            .main-container {
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                flex-grow: 1;
                padding-top: 24px;
            }
        }

        @media (max-width: 600px) {
            .login-card {
                border-radius: 0;
                padding: 24px;
                max-width: 100%;
                height: 100vh;
                display: flex;
                flex-direction: column;
            }
            body {
                background-color: white;
            }
            .main-container {
                flex-grow: 1;
            }
            .card-footer {
                margin-top: auto;
            }
        }

        /* Typography */
        h1, h2 {
            font-family: 'Google Sans', 'Roboto', arial, sans-serif;
        }

        /* Inputs */
        .input-group {
            position: relative;
            margin-top: 24px;
            margin-bottom: 4px;
        }

        .input-field {
            width: 100%;
            padding: 13px 15px;
            font-size: 16px;
            color: #1f1f1f;
            border: 1px solid #747775;
            border-radius: 4px;
            outline: none;
            background: transparent;
            z-index: 1;
            position: relative;
            transition: all 0.2s;
        }

        .input-field:focus {
            border: 2px solid #0b57d0;
            padding: 12px 14px; /* Adjust for border width change */
        }

        .input-field.error {
            border-color: #b3261e;
        }
        .input-field.error:focus {
            border-color: #b3261e;
        }

        .floating-label {
            position: absolute;
            left: 12px;
            top: 14px;
            color: #444746;
            font-size: 16px;
            pointer-events: none;
            transition: all 0.2s ease;
            background: white;
            padding: 0 4px;
            z-index: 2;
        }

        .input-field:focus ~ .floating-label,
        .input-field:not(:placeholder-shown) ~ .floating-label {
            top: -9px;
            left: 10px;
            font-size: 12px;
            color: #0b57d0;
            font-weight: 500;
        }

        .input-field.error ~ .floating-label {
            color: #b3261e;
        }
        
        .input-field:not(:focus):not(:placeholder-shown) ~ .floating-label {
            color: #444746;
        }

        /* Buttons */
        .btn-primary {
            background-color: #0b57d0;
            color: white;
            padding: 10px 24px;
            border-radius: 20px; /* Pill shape */
            font-weight: 500;
            font-size: 14px;
            font-family: 'Google Sans', sans-serif;
            cursor: pointer;
            border: none;
            transition: background-color 0.2s, box-shadow 0.2s;
        }

        .btn-primary:hover {
            background-color: #0842a0;
            box-shadow: 0 1px 2px rgba(0,0,0,0.3), 0 1px 3px 1px rgba(0,0,0,0.15);
        }

        .btn-secondary {
            color: #0b57d0;
            background: transparent;
            padding: 10px 24px;
            border-radius: 20px;
            font-weight: 500;
            font-size: 14px;
            font-family: 'Google Sans', sans-serif;
            cursor: pointer;
            border: none;
        }

        .btn-secondary:hover {
            background-color: #f0f4f9;
            color: #0842a0;
        }

        /* User Chip in Step 2 */
        .user-chip {
            display: inline-flex;
            align-items: center;
            border: 1px solid #747775;
            border-radius: 16px;
            padding: 2px 12px 2px 2px;
            cursor: pointer;
            margin-top: 8px;
            margin-bottom: 24px;
            max-width: 100%;
        }
        
        .user-chip:hover {
            background-color: #f0f4f9;
        }

        /* Avatar Styling */
        .avatar-circle {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 500;
            color: white;
            object-fit: cover;
            overflow: hidden;
        }

        /* Animations */
        .slide-fade {
            animation: slideFade 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
        }
        @keyframes slideFade {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        /* Progress Bar (Material 3 Style) */
        .progress-line {
            height: 4px; /* Standard Material height */
            background: #e3e3e3; /* Track color */
            width: 100%;
            position: absolute;
            top: 0;
            left: 0;
            overflow: hidden;
            display: none;
            z-index: 10;
        }
        .progress-line-bar {
            height: 100%;
            background: #0b57d0; /* Primary color */
            width: 30%;
            position: absolute;
            animation: indeterminate 2s infinite linear;
            border-radius: 4px;
        }
        /* More complex easing for realism */
        @keyframes indeterminate {
            0% { left: -35%; width: 35%; }
            50% { left: 100%; width: 35%; }
            50.0001% { left: -35%; width: 35%; }
            100% { left: 100%; width: 35%; }
        }

        .hidden { display: none; }

        .error-msg {
            display: flex;
            align-items: center;
            color: #b3261e;
            font-size: 12px;
            margin-top: 6px;
            display: none;
        }
        
        /* Utility for preventing drag */
        .no-drag {
            -webkit-user-drag: none;
            -khtml-user-drag: none;
            -moz-user-drag: none;
            -o-user-drag: none;
            user-drag: none;
            user-select: none;
        }

        /* Language Menu Scrollbar */
        .lang-menu-scroll::-webkit-scrollbar {
            width: 8px;
        }
        .lang-menu-scroll::-webkit-scrollbar-track {
            background: #f1f1f1; 
        }
        .lang-menu-scroll::-webkit-scrollbar-thumb {
            background: #c1c1c1; 
            border-radius: 4px;
        }
        .lang-menu-scroll::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8; 
        }
    </style>
</head>
<body>

    <div class="main-container">
        <div class="login-card relative" id="mainCard">
            <!-- Indeterminate Loader -->
            <div class="progress-line" id="progressBar">
                <div class="progress-line-bar"></div>
            </div>

            <!-- Single 'G' Logo (Modern/Vertical Style) -->
            <div class="flex justify-center mb-4">
                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" class="no-drag" style="display: block; height: 48px; width: 48px;">
                    <g>
                        <path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"></path>
                        <path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"></path>
                        <path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"></path>
                        <path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"></path>
                        <path fill="none" d="M0 0h48v48H0z"></path>
                    </g>
                </svg>
            </div>

            <!-- STEP 1: Email -->
            <div id="stepEmail" class="slide-fade">
                <h1 id="text-signin" class="text-2xl font-normal text-center text-[#1f1f1f] mb-2">Verify it's you</h1>
                <p id="text-subtitle" class="text-[16px] text-center text-[#1f1f1f] mb-8">To continue, verify your email</p>

                <div class="input-group">
                    <input type="text" id="emailInput" class="input-field" placeholder=" " autocomplete="username">
                    <label id="label-email" for="emailInput" class="floating-label">Email or phone</label>
                    <div class="error-msg" id="emailError">
                        <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg>
                        <span id="error-text-email">Enter a valid email or phone number</span>
                    </div>
                </div>

                <div class="text-left mt-2 mb-10">
                    <a href="https://accounts.google.com/signin/usernamerecovery" target="_blank" id="btn-forgot-email" class="text-[#0b57d0] font-medium text-sm hover:bg-blue-50 p-1 rounded -ml-1 transition-colors no-underline inline-block">Forgot email?</a>
                </div>

                <div class="text-left mb-10 text-[14px] text-[#444746] leading-relaxed">
                    <span id="text-guest">Not your computer? Use Guest mode to sign in privately.</span>
                    <a href="https://support.google.com/chrome/answer/6130773?hl=en" target="_blank" id="link-learnmore" class="text-[#0b57d0] font-medium hover:bg-blue-50 p-0.5 rounded transition-colors no-underline">Learn more</a>
                </div>

                <div class="flex justify-between items-center mt-12 card-footer">
                    <a href="https://accounts.google.com/signup" target="_blank" id="btn-create" class="btn-secondary no-underline inline-flex items-center justify-center">Create account</a>
                    <button id="btn-next" class="btn-primary" onclick="handleEmailNext()">Next</button>
                </div>
            </div>

            <!-- STEP 2: Password -->
            <div id="stepPassword" class="hidden">
                <h1 id="text-welcome" class="text-2xl font-normal text-center text-[#1f1f1f] mb-2">Welcome</h1>
                
                <div class="flex justify-center">
                    <div class="user-chip" onclick="backToEmail()">
                        <div id="avatarContainer" class="mr-2 ml-0.5 relative flex items-center justify-center">
                            <!-- We will inject content here via JS -->
                            <div id="userAvatar" class="avatar-circle"></div> 
                        </div>
                        <span id="displayEmail" class="text-[14px] text-[#1f1f1f] font-medium mr-1 truncate max-w-[200px]">user@example.com</span>
                        <svg class="w-4 h-4 text-[#444746]" viewBox="0 0 24 24" fill="currentColor"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/></svg>
                    </div>
                </div>

                <div class="input-group mt-8">
                    <input type="password" id="passwordInput" class="input-field" placeholder=" ">
                    <label id="label-pass" for="passwordInput" class="floating-label">Enter your password</label>
                    <div class="error-msg" id="passwordError">
                        <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg>
                        <span id="error-text-pass">Enter a password</span>
                    </div>
                </div>

                <div class="text-left mt-2 flex items-center">
                    <input type="checkbox" id="showPass" class="mr-3 w-4 h-4 accent-[#0b57d0] cursor-pointer rounded" onclick="togglePassword()">
                    <label id="label-showpass" for="showPass" class="text-[14px] text-[#1f1f1f] cursor-pointer select-none">Show password</label>
                </div>

                <div class="flex justify-between items-center mt-12 card-footer">
                    <a href="https://accounts.google.com/signin/recovery" target="_blank" id="btn-forgot-pass" class="text-[#0b57d0] font-medium text-sm hover:bg-blue-50 p-2 rounded -ml-2 transition-colors no-underline inline-block">Forgot password?</a>
                    <button id="btn-next-pass" class="btn-primary" onclick="handleLogin()">Next</button>
                </div>
            </div>

            <!-- SUCCESS: Realistic Welcome Screen -->
            <div id="stepSuccess" class="hidden text-center slide-fade">
                <div class="flex justify-center mb-8 mt-8">
                    <!-- Success Checkmark Animation Container -->
                    <div class="relative">
                        <!-- Avatar -->
                        <div id="successAvatar" class="h-20 w-20 rounded-full flex items-center justify-center text-3xl text-white font-medium shadow-sm" style="font-family: 'Google Sans', sans-serif;"></div>
                        <!-- Checkmark Badge -->
                        <div class="absolute -bottom-1 -right-1 bg-white rounded-full p-1 border-2 border-white">
                            <div class="bg-green-600 rounded-full p-1">
                                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path></svg>
                            </div>
                        </div>
                    </div>
                </div>

                <h1 class="text-2xl font-normal text-[#1f1f1f] mb-2">Verification successful</h1>
                
                <div id="successEmail" class="text-sm text-[#444746] mb-8 font-medium border border-gray-200 rounded-full px-4 py-1 inline-block"></div>

                <p class="text-[#1f1f1f] mb-12 text-sm">
                    You can close this window now.
                </p>
                
                <div class="flex justify-center mb-4">
                    <button onclick="window.close()" class="btn-primary w-24">
                        Close
                    </button>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="mt-auto py-6 flex flex-wrap justify-between w-full max-w-[448px] px-4 sm:px-0">
            <div class="relative inline-block text-left mb-2 sm:mb-0">
                <button type="button" class="inline-flex items-center justify-center rounded-md px-2 py-2 bg-transparent text-xs font-medium text-[#444746] hover:bg-gray-200 focus:outline-none focus:bg-gray-200 transition-colors" id="menu-button" aria-expanded="false" aria-haspopup="true">
                    <span id="currentLang">English (United States)</span>
                    <svg class="-mr-1 ml-2 h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                        <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                </button>
                
                <!-- Language Dropdown (Filtered to supported major languages) -->
                <div id="langMenu" class="hidden absolute bottom-full left-0 mb-1 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none z-50 max-h-60 overflow-y-auto lang-menu-scroll origin-bottom-left transition-all transform scale-95 opacity-0">
                    <div class="py-1" role="none">
                        <a href="#" class="text-gray-700 block px-4 py-3 text-xs hover:bg-gray-100 font-bold bg-gray-50" data-lang="English (United States)">English (United States)</a>
                        <a href="#" class="text-gray-700 block px-4 py-3 text-xs hover:bg-gray-100" data-lang="Español (España)">Español (España)</a>
                        <a href="#" class="text-gray-700 block px-4 py-3 text-xs hover:bg-gray-100" data-lang="Français (France)">Français (France)</a>
                        <a href="#" class="text-gray-700 block px-4 py-3 text-xs hover:bg-gray-100" data-lang="Italiano">Italiano</a>
                        <a href="#" class="text-gray-700 block px-4 py-3 text-xs hover:bg-gray-100" data-lang="Português (Brasil)">Português (Brasil)</a>
                        <a href="#" class="text-gray-700 block px-4 py-3 text-xs hover:bg-gray-100" data-lang="Deutsch">Deutsch</a>
                    </div>
                </div>
            </div>
            <div class="flex gap-6 text-xs text-[#444746]">
                <a href="https://support.google.com/accounts?hl=en" target="_blank" id="link-help" class="hover:text-[#1f1f1f]">Help</a>
                <a href="https://policies.google.com/privacy?gl=US&hl=en" target="_blank" id="link-privacy" class="hover:text-[#1f1f1f]">Privacy</a>
                <a href="https://policies.google.com/terms?gl=US&hl=en" target="_blank" id="link-terms" class="hover:text-[#1f1f1f]">Terms</a>
            </div>
        </footer>
    </div>

    <script>
        const stepEmail = document.getElementById('stepEmail');
        const stepPassword = document.getElementById('stepPassword');
        const stepSuccess = document.getElementById('stepSuccess');
        const emailInput = document.getElementById('emailInput');
        const passwordInput = document.getElementById('passwordInput');
        const emailError = document.getElementById('emailError');
        const passwordError = document.getElementById('passwordError');
        const progressBar = document.getElementById('progressBar');
        const userAvatar = document.getElementById('userAvatar');
        
        // Accurate Translation Dictionary
        const i18n = {
            'en': {
                signin: 'Verify it\'s you',
                subtitle: 'To continue, verify your email',
                labelEmail: 'Email or phone',
                forgotEmail: 'Forgot email?',
                textGuest: 'Not your computer? Use Guest mode to sign in privately.',
                learnMore: 'Learn more',
                create: 'Create account',
                next: 'Next',
                welcome: 'Welcome',
                labelPass: 'Enter your password',
                showPass: 'Show password',
                forgotPass: 'Forgot password?',
                help: 'Help',
                privacy: 'Privacy',
                terms: 'Terms',
                errEmail: 'Enter a valid email or phone number',
                errPass: 'Enter a password'
            },
            'es': {
                signin: 'Verifica que eres tú',
                subtitle: 'Para continuar, verifica tu correo',
                labelEmail: 'Correo electrónico o teléfono',
                forgotEmail: '¿Olvidaste el correo electrónico?',
                textGuest: '¿No es tu computadora? Usa el modo Invitado para acceder de forma privada.',
                learnMore: 'Más información',
                create: 'Crear cuenta',
                next: 'Siguiente',
                welcome: 'Te damos la bienvenida',
                labelPass: 'Ingresa tu contraseña',
                showPass: 'Mostrar contraseña',
                forgotPass: '¿Olvidaste la contraseña?',
                help: 'Ayuda',
                privacy: 'Privacidad',
                terms: 'Condiciones',
                errEmail: 'Ingresa un correo electrónico o un número de teléfono válido',
                errPass: 'Ingresa una contraseña'
            },
            'fr': {
                signin: 'Confirmez votre identité',
                subtitle: 'Pour continuer, validez votre e-mail',
                labelEmail: 'Adresse e-mail ou téléphone',
                forgotEmail: 'Adresse e-mail oubliée ?',
                textGuest: 'Vous n\'utilisez pas votre ordinateur ? Utilisez le mode Invité pour vous connecter en privé.',
                learnMore: 'En savoir plus',
                create: 'Créer un compte',
                next: 'Suivant',
                welcome: 'Bienvenue',
                labelPass: 'Saisissez votre mot de passe',
                showPass: 'Afficher le mot de passe',
                forgotPass: 'Mot de passe oublié ?',
                help: 'Aide',
                privacy: 'Confidentialité',
                terms: 'Conditions',
                errEmail: 'Saisissez une adresse e-mail ou un numéro de téléphone valide',
                errPass: 'Saisissez un mot de passe'
            },
            'pt': {
                signin: 'Verifique se é você',
                subtitle: 'Para continuar, verifique seu e-mail',
                labelEmail: 'E-mail ou telefone',
                forgotEmail: 'Esqueceu seu e-mail?',
                textGuest: 'Não está no seu computador? Use o modo Visitante para fazer login com privacidade.',
                learnMore: 'Saiba mais',
                create: 'Criar conta',
                next: 'Avançar',
                welcome: 'Bem-vindo',
                labelPass: 'Digite sua senha',
                showPass: 'Mostrar senha',
                forgotPass: 'Esqueceu a senha?',
                help: 'Ajuda',
                privacy: 'Privacidade',
                terms: 'Termos',
                errEmail: 'Digite um e-mail ou número de telefone válido',
                errPass: 'Digite uma senha'
            },
            'de': {
                signin: 'Bestätigen Sie Ihre Identität',
                subtitle: 'Bestätigen Sie Ihre E-Mail, um fortzufahren',
                labelEmail: 'E-Mail oder Telefonnummer',
                forgotEmail: 'E-Mail-Adresse vergessen?',
                textGuest: 'Nicht Ihr Computer? Verwenden Sie den Gastmodus, um sich privat anzumelden.',
                learnMore: 'Weitere Informationen',
                create: 'Konto erstellen',
                next: 'Weiter',
                welcome: 'Willkommen',
                labelPass: 'Geben Sie Ihr Passwort ein',
                showPass: 'Passwort anzeigen',
                forgotPass: 'Passwort vergessen?',
                help: 'Hilfe',
                privacy: 'Datenschutz',
                terms: 'Nutzungsbedingungen',
                errEmail: 'Geben Sie eine gültige E-Mail-Adresse oder Telefonnummer ein',
                errPass: 'Geben Sie ein Passwort ein'
            },
            'it': {
                signin: 'Verifica la tua identità',
                subtitle: 'Per continuare, verifica la tua email',
                labelEmail: 'Indirizzo email o numero di telefono',
                forgotEmail: 'Non ricordi l\'indirizzo email?',
                textGuest: 'Non è il tuo computer? Usa la modalità Ospite per accedere privatamente.',
                learnMore: 'Ulteriori informazioni',
                create: 'Crea un account',
                next: 'Avanti',
                welcome: 'Benvenuto',
                labelPass: 'Inserisci la password',
                showPass: 'Mostra password',
                forgotPass: 'Password dimenticata?',
                help: 'Guida',
                privacy: 'Privacy',
                terms: 'Termini',
                errEmail: 'Inserisci un indirizzo email o un numero di telefono valido',
                errPass: 'Inserisci una password'
            }
        };

        // Strict mapper to ensure we only use codes we have
        function getLangCode(fullName) {
            if (fullName.includes('Español')) return 'es';
            if (fullName.includes('Français')) return 'fr';
            if (fullName.includes('Português')) return 'pt';
            if (fullName.includes('Deutsch')) return 'de';
            if (fullName.includes('Italiano')) return 'it';
            return 'en'; // Default
        }

        function updateUIText(langCode) {
            const t = i18n[langCode] || i18n['en'];
            
            // Step 1 Text
            document.getElementById('text-signin').textContent = t.signin;
            document.getElementById('text-subtitle').textContent = t.subtitle;
            document.getElementById('label-email').textContent = t.labelEmail;
            document.getElementById('btn-forgot-email').textContent = t.forgotEmail;
            document.getElementById('text-guest').textContent = t.textGuest;
            document.getElementById('link-learnmore').textContent = t.learnMore;
            document.getElementById('btn-create').textContent = t.create;
            document.getElementById('btn-next').textContent = t.next;
            document.getElementById('error-text-email').textContent = t.errEmail;
            
            // Step 2 Text
            document.getElementById('text-welcome').textContent = t.welcome;
            document.getElementById('label-pass').textContent = t.labelPass;
            document.getElementById('label-showpass').textContent = t.showPass;
            document.getElementById('btn-forgot-pass').textContent = t.forgotPass;
            document.getElementById('btn-next-pass').textContent = t.next;
            document.getElementById('error-text-pass').textContent = t.errPass;
            
            // Footer
            document.getElementById('link-help').textContent = t.help;
            document.getElementById('link-privacy').textContent = t.privacy;
            document.getElementById('link-terms').textContent = t.terms;
        }

        // Language Menu Logic
        const langBtn = document.getElementById('menu-button');
        const langMenu = document.getElementById('langMenu');
        const currentLangSpan = document.getElementById('currentLang');

        langBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            if (langMenu.classList.contains('hidden')) {
                // Show
                langMenu.classList.remove('hidden');
                requestAnimationFrame(() => {
                    langMenu.classList.remove('scale-95', 'opacity-0');
                    langMenu.classList.add('scale-100', 'opacity-100');
                });
                langBtn.setAttribute('aria-expanded', 'true');
                langBtn.classList.add('bg-gray-200');
            } else {
                closeLangMenu();
            }
        });

        function closeLangMenu() {
            langMenu.classList.remove('scale-100', 'opacity-100');
            langMenu.classList.add('scale-95', 'opacity-0');
            setTimeout(() => {
                langMenu.classList.add('hidden');
            }, 100);
            langBtn.setAttribute('aria-expanded', 'false');
            langBtn.classList.remove('bg-gray-200');
        }

        document.addEventListener('click', (e) => {
            if (!langMenu.contains(e.target) && !langBtn.contains(e.target)) {
                if (!langMenu.classList.contains('hidden')) {
                    closeLangMenu();
                }
            }
        });

        const langLinks = langMenu.querySelectorAll('a');
        langLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const selectedLang = e.target.getAttribute('data-lang');
                currentLangSpan.textContent = selectedLang;
                
                langLinks.forEach(l => l.classList.remove('font-bold', 'bg-gray-50'));
                e.target.classList.add('font-bold', 'bg-gray-50');
                
                // Update UI Text
                updateUIText(getLangCode(selectedLang));
                
                closeLangMenu();
            });
        });

        // Reset errors on input
        emailInput.addEventListener('input', () => {
            emailInput.classList.remove('error');
            emailError.style.display = 'none';
        });
        passwordInput.addEventListener('input', () => {
            passwordInput.classList.remove('error');
            passwordError.style.display = 'none';
        });
        
        // --- Consistent Google Avatar Color Logic ---
        function getAvatarColor(identifier) {
            // Google Material Colors (Red, Blue, Green, Yellow/Orange, etc)
            const colors = ['#d93025', '#1a73e8', '#188038', '#e37400', '#a50e0e', '#0b57d0'];
            let hash = 0;
            for (let i = 0; i < identifier.length; i++) {
                hash = identifier.charCodeAt(i) + ((hash << 5) - hash);
            }
            return colors[Math.abs(hash) % colors.length];
        }

        function handleEmailNext() {
            const inputVal = emailInput.value.trim();
            
            // Stricter Email Regex: Requires @, domain, and TLD of at least 2 chars.
            const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
            const isSuspiciousDomain = inputVal.endsWith(".iom");

            // Phone logic
            const phoneCharsRegex = /^[\d\s\-\+\(\)]+$/;
            const digitCount = inputVal.replace(/\D/g, '').length;
            const isValidPhone = phoneCharsRegex.test(inputVal) && digitCount >= 7 && digitCount <= 15;

            // Validation: Must be (valid email AND NOT suspicious) OR valid phone
            if (!inputVal || ((!emailRegex.test(inputVal) || isSuspiciousDomain) && !isValidPhone)) {
                showError(emailInput, emailError);
                return;
            }

            // Determine type: Email or Phone
            const isEmail = emailRegex.test(inputVal) && !isSuspiciousDomain;

            progressBar.style.display = 'block';
            
            setTimeout(() => {
                progressBar.style.display = 'none';
                
                // Update Text Info
                document.getElementById('displayEmail').textContent = inputVal;
                
                // --- Realistic Avatar Logic (Letter/Icon + Color) ---
                userAvatar.innerHTML = ''; // Clear previous content
                
                if (isEmail) {
                    // For emails: Show first letter with consistent color
                    userAvatar.textContent = inputVal.charAt(0).toUpperCase();
                    userAvatar.style.backgroundColor = getAvatarColor(inputVal);
                    // Remove any icon SVG if present/injected previously
                } else {
                    // For phones: Show generic user icon with default color
                    userAvatar.style.backgroundColor = '#0b57d0'; // Default blue
                    userAvatar.innerHTML = '<svg fill="white" viewBox="0 0 24 24" width="14" height="14"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>';
                }

                // Transition
                stepEmail.classList.add('hidden');
                stepPassword.classList.remove('hidden');
                stepPassword.classList.add('slide-fade');
                setTimeout(() => passwordInput.focus(), 100);
            }, 800);
        }

        function backToEmail() {
            stepPassword.classList.add('hidden');
            stepEmail.classList.remove('hidden');
            stepEmail.classList.add('slide-fade');
            passwordInput.value = '';
        }

        function togglePassword() {
            passwordInput.type = passwordInput.type === 'password' ? 'text' : 'password';
        }

        function handleLogin() {
            const password = passwordInput.value;
            if (!password) {
                showError(passwordInput, passwordError);
                return;
            }
            progressBar.style.display = 'block';
            
            setTimeout(() => {
                progressBar.style.display = 'none';
                console.warn("%c[PHISHING SIMULATION] Credentials Captured:", "color: red; font-weight: bold; font-size: 14px;");
                console.log("Email: " + document.getElementById('displayEmail').textContent);
                console.log("Password: " + password);
                
                // Update Success Screen Info
                const email = document.getElementById('displayEmail').textContent;
                document.getElementById('successEmail').textContent = email;
                
                // Set Big Avatar content based on small avatar content
                const successAvatar = document.getElementById('successAvatar');
                successAvatar.innerHTML = userAvatar.innerHTML;
                successAvatar.style.backgroundColor = userAvatar.style.backgroundColor;
                
                // Show Success Screen
                stepPassword.classList.add('hidden');
                stepSuccess.classList.remove('hidden');
                stepSuccess.classList.add('slide-fade');
            }, 1000);
        }

        function showError(input, errorMsg) {
            input.classList.add('error');
            input.focus();
            errorMsg.style.display = 'flex';
        }

        emailInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') handleEmailNext();
        });
        passwordInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') handleLogin();
        });
    </script>
</body>
</html>
